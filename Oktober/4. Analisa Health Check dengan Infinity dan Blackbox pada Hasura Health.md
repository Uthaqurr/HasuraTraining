# Analisa Health Check dengan Blackbox dan infinity pada HASURA HEALTH


## 1. Analisa Helath dengan Blackbox

Untuk memantau status kesehatan Hasura menggunakan Blackbox di Grafana, langkah-langkahnya melibatkan integrasi Blackbox Exporter Prometheus untuk melakukan ping atau HTTP request ke endpoint Hasura, seperti /healthz. Data ini kemudian diolah oleh Prometheus dan ditampilkan di Grafana. Untuk itu ada beberapa tahapan seperti :

* Konfigurasi Blackbox Exporter untuk memeriksa endpoint kesehatan Hasura.
* Tambahkan aturan scraping di Prometheus.
* Membuat dashboard Grafana untuk menampilkan status kesehatan berdasarkan data Prometheus.


### * Apa itu Blackbox Testing dan Blackbox Exporter ?

* Blackbox Testing adalah metode pengujian perangkat lunak di mana fungsionalitas aplikasi diuji tanpa mengetahui detail internal atau kode sumbernya. Fokusnya pada input    dan output tanpa memperhatikan cara kerjanya.

* Blackbox Exporter di Grafana adalah alat dari Prometheus yang digunakan untuk memantau status layanan eksternal, seperti melakukan ping atau HTTP request ke endpoint       aplikasi (misalnya /healthz). Ini membantu memeriksa apakah aplikasi berjalan normal berdasarkan respons eksternal.

### * Apa itu Prometheus ?

Prometheus adalah sistem monitoring dan pengumpulan data berbasis time-series yang terintegrasi dengan Grafana. Prometheus berfungsi mengumpulkan metrik dari berbagai sumber, seperti layanan atau aplikasi, lalu menyimpannya dalam database time-series. Data ini kemudian dapat divisualisasikan dalam bentuk grafik di Grafana. Dengan Prometheus, pengguna dapat memantau kinerja sistem secara real-time, membuat alert, dan menganalisis data historis. Kombinasi ini sangat efektif untuk memantau infrastruktur dan aplikasi dalam lingkungan produksi.

### * Cara melakukan Blackbox Testing dan Instalasi Prometheus Blackbox

Berikut cara melakukan Blackbox Testing di Grafana:

* Instal Prometheus Blackbox Exporter: Alat ini digunakan untuk menguji endpoint layanan dari luar.

* Melakukan konfigurasi Blackbox Exporter: Sesuaikan konfigurasi untuk memeriksa endpoint yang ingin diuji (misalnya, HTTP, HTTPS, ping).

* Melakukan integrasi dengan Prometheus: Tambahkan Blackbox Exporter ke file konfigurasi Prometheus untuk mulai melakukan scraping data dari endpoint tersebut.

* Membuat Dashboard Grafana: Visualisasikan metrik Blackbox Exporter di Grafana untuk memantau status layanan secara real-time.


Adapun untuk instalasi Prometheus Blackbox adalah sebagai berikut :

* Unduh Blackbox Exporter dari [GitHub](https://github.com/prometheus/blackbox_exporter/releases).
  
* Jalankan Blackbox Exporter dengan perintah ./blackbox_exporter --config.file=blackbox.yml.
  
* Integrasikan dengan Prometheus melalui konfigurasi di prometheus.yml untuk mulai mengumpulkan metrik dari Blackbox Exporter.

  Untuk lebih rincinya adalah sebagai berikut:

  #### 1. Menambahkan konfigurasi Blackbox Exporter ke Prometheus

  Dengan cara membuka file prometheus.yml dan tambahkan konfigurasi seperti ini:

  ```
  scrape_configs:
  - job_name: 'blackbox'
    metrics_path: /probe
    params:
      module: [http_2xx]  # Sesuaikan modul sesuai kebutuhan (http_2xx, icmp, dll)
    static_configs:
      - targets:
        - http://example.com  # Target yang ingin dipantau
    relabel_configs:
      - source_labels: [__address__]
        target_label: __param_target
      - target_label: instance
        replacement: example.com
      - target_label: __address__
        replacement: 127.0.0.1:9115  # Alamat Blackbox Exporter


  ```
  #### 2. Menjalankan Prometheus

  Menjalankan prometheus adalah dengan melakukan restart untuk memuat konfigurasi yang baru dimasukkan.


  #### 3. Visualisasikan di Grafana

  Tambahkan Prometheus sebagai datasource di Grafana, lalu buat dashboard untuk memvisualisasikan metrik yang dipantau.
        
      
  
  
* Buat Dashboard di Grafana untuk memvisualisasikan metrik yang dihasilkan oleh Blackbox Exporter.



## 2. Analisa Helath dengan Infinity
